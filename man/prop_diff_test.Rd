% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/test_proportion_diff.R
\name{prop_diff_test}
\alias{prop_diff_test}
\alias{a_test_proportion_diff}
\alias{s_test_proportion_diff}
\title{Difference test for two proportions}
\usage{
a_test_proportion_diff(
  df,
  .var,
  ref_path,
  .spl_context,
  ...,
  .stats = NULL,
  .formats = NULL,
  .labels = NULL,
  .indent_mods = NULL
)

s_test_proportion_diff(
  df,
  .var,
  .ref_group,
  .in_ref_col,
  variables = list(strata = NULL),
  method = c("chisq", "fisher", "cmh"),
  alternative = c("two.sided", "less", "greater")
)
}
\arguments{
\item{df}{(`data.frame`)\cr data set containing all analysis variables.}

\item{.var}{(`string`)\cr single variable name that is passed by `rtables` when requested
by a statistics function.}

\item{ref_path}{(`character`)\cr global reference group specification, see [get_ref_info()].}

\item{.spl_context}{(`data.frame`)\cr gives information about ancestor split states
that is passed by `rtables`.}

\item{...}{additional arguments for the lower level functions.}

\item{.stats}{(`character`)\cr statistics to select for the table.}

\item{.formats}{(named `character` or `list`)\cr formats for the statistics. See Details in `analyze_vars` for more
information on the `'auto'` setting.}

\item{.labels}{(named `character`)\cr labels for the statistics (without indent).}

\item{.indent_mods}{(named `integer`)\cr indent modifiers for the labels. Defaults to 0, which corresponds to the
unmodified default behavior. Can be negative.}

\item{.ref_group}{(`data.frame` or `vector`)\cr the data corresponding to the reference group.}

\item{.in_ref_col}{(`logical`)\cr `TRUE` when working with the reference level, `FALSE` otherwise.}

\item{variables}{(named `list` of `string`)\cr list of additional analysis variables.}

\item{method}{(`string`)\cr one of `chisq`, `cmh`, `fisher`; specifies the test used
to calculate the p-value.}

\item{alternative}{(`string`)\cr whether `two.sided`, or one-sided `less` or `greater` p-value
should be displayed.}
}
\value{
* `a_test_proportion_diff()` returns the corresponding list with formatted [rtables::CellValue()].

* `s_test_proportion_diff()` returns a named `list` with a single item `pval` with an attribute `label`
  describing the method used. The p-value tests the null hypothesis that proportions in two groups are the same.
}
\description{
`r lifecycle::badge('stable')`

The analysis function [a_test_proportion_diff()] can be used to create a layout element to test
the difference between two proportions. The primary analysis variable, `vars`, indicates whether a
response has occurred for each record. See the `method` parameter for options of methods to use
to calculate the p-value. Additionally, a stratification variable can be supplied via the `strata`
element of the `variables` argument. The argument `alternative` specifies the direction of the
alternative hypothesis.
}
\section{Functions}{
\itemize{
\item \code{a_test_proportion_diff()}: Formatted analysis function which is used as `afun`

\item \code{s_test_proportion_diff()}: Statistics function which tests the difference between two proportions.

}}
\note{
These functions have been forked from the `tern` package. Additional features are:

  * Additional `alternative` argument for the sidedness of the test.
  * Additional `ref_path` argument for flexible reference column path specification.
}
\examples{
dta <- data.frame(
  rsp = sample(c(TRUE, FALSE), 100, TRUE),
  grp = factor(rep(c('A', 'B'), each = 50)),
  strata = factor(rep(c('V', 'W', 'X', 'Y', 'Z'), each = 20))
)

# With `rtables` pipelines.
l <- basic_table() |>
  split_cols_by(var = 'grp') |>
  analyze(
    vars = 'rsp',
    afun = a_test_proportion_diff,
    show_labels = 'hidden',
    extra_args = list(
      method = 'cmh',
      variables = list(strata = 'strata'),
      ref_path = c('grp', 'B')
    )
  )

build_table(l, df = dta)

}
\seealso{
[h_prop_diff_test]
}
\keyword{internal}
