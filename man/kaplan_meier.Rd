% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/kaplan_meier.R
\name{kaplan_meier}
\alias{kaplan_meier}
\alias{a_kaplan_meier}
\alias{s_kaplan_meier}
\title{Survival time analysis}
\usage{
a_kaplan_meier(
  df,
  .var,
  ...,
  .stats = NULL,
  .formats = NULL,
  .labels = NULL,
  .indent_mods = NULL
)

s_kaplan_meier(df, .var, is_event, control = control_surv_time())
}
\arguments{
\item{df}{(`data.frame`)\cr data set containing all analysis variables.}

\item{.var}{(`string`)\cr single variable name that is passed by `rtables` when requested
by a statistics function.}

\item{...}{additional arguments for the lower level functions.}

\item{.stats}{(`character`)\cr statistics to select for the table.}

\item{.formats}{(named `character` or `list`)\cr formats for the statistics. See Details in `analyze_vars` for more
information on the `'auto'` setting.}

\item{.labels}{(named `character`)\cr labels for the statistics (without indent).}

\item{.indent_mods}{(named `integer`)\cr indent modifiers for the labels. Defaults to 0, which corresponds to the
unmodified default behavior. Can be negative.}

\item{is_event}{(`character`)\cr variable name storing Logical values: `TRUE` if event,
`FALSE` if time to event is censored.}

\item{control}{(`list`)\cr parameters for comparison details, specified by using the helper function
[tern::control_surv_time()]. Some possible parameter options are:
* `conf_level` (`proportion`)\cr confidence level of the interval for survival time.
* `conf_type` (`string`)\cr confidence interval type. Options are 'plain' (default), 'log', or 'log-log',
  see more in [survival::survfit()]. Note option 'none' is not supported.
* `quantiles` (`numeric`)\cr vector of length two to specify the quantiles of survival time.}
}
\value{
* `a_kaplan_meier()` returns the corresponding list with formatted [rtables::CellValue()].

* `s_kaplan_meier()` returns the following statistics:
  * `quantiles_lower`: Lower quantile estimate and confidence interval for it.
  * `median_ci_3d`: Median survival time and confidence interval for it.
  * `quantiles_upper`: Upper quantile estimate and confidence interval for it.
  * `range_with_cens_info`: Survival time range with censoring information.
}
\description{
`r lifecycle::badge('stable')`

The analyze function [kaplan_meier()] creates a layout element to analyze
survival time by calculating survival time median, 2 quantiles, each with
their confidence intervals, and range (for all, censored, or event patients).
The primary analysis variable `vars` is the time variable and the secondary
analysis variable `is_event` indicates whether or not an event has occurred.
}
\section{Functions}{
\itemize{
\item \code{a_kaplan_meier()}: Formatted analysis function which is used as `afun`

\item \code{s_kaplan_meier()}: Statistics function which analyzes survival times using Kaplan-Meier.

}}
\note{
These functions have been forked from the `tern` package file `survival_time.R`.
  Here we have the additional features:

  * Additional statistics `quantiles_lower`, `quantiles_upper`, `range_with_cens_info` are returned.
}
\examples{
library(dplyr)
library(tern)
adtte_f <- tern::tern_ex_adtte |>
  filter(PARAMCD == "OS") |>
  mutate(
    AVAL = tern::day2month(AVAL),
    is_event = CNSR == 0
  )
df <- adtte_f |> filter(ARMCD == 'ARM A')
a_kaplan_meier(
  df,
  .var = 'AVAL',
  is_event = 'is_event'
)

basic_table() |>
  split_cols_by(var = 'ARMCD') |>
  add_colcounts() |>
  analyze(
    vars = 'AVAL',
    afun = a_kaplan_meier,
    var_labels = 'Kaplan-Meier estimate of time to event (months)',
    show_labels = 'visible',
    extra_args = list(
      is_event = 'is_event',
      control = control_surv_time(conf_level = 0.9, conf_type = 'log-log')
    )
  ) |>
  build_table(df = adtte_f)

}
\keyword{internal}
