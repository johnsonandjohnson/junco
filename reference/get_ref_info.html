<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Obtain Reference Information for a Global Reference Group — get_ref_info • junco</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Obtain Reference Information for a Global Reference Group — get_ref_info"><meta name="description" content="This helper function can be used in custom analysis functions, by passing
an extra argument `ref_path` which defines a global reference group by
the corresponding column split hierarchy levels."><meta property="og:description" content="This helper function can be used in custom analysis functions, by passing
an extra argument `ref_path` which defines a global reference group by
the corresponding column split hierarchy levels."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">junco</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/index.html">Articles</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/johnsonandjohnson/junco/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Obtain Reference Information for a Global Reference Group</h1>
      <small class="dont-index">Source: <a href="https://github.com/johnsonandjohnson/junco/blob/ci_cd/R/get_ref_info.R" class="external-link"><code>R/get_ref_info.R</code></a></small>
      <div class="d-none name"><code>get_ref_info.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This helper function can be used in custom analysis functions, by passing
an extra argument `ref_path` which defines a global reference group by
the corresponding column split hierarchy levels.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">get_ref_info</span><span class="op">(</span><span class="va">ref_path</span>, <span class="va">.spl_context</span>, .var <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-ref-path">ref_path<a class="anchor" aria-label="anchor" href="#arg-ref-path"></a></dt>
<dd><p>(`character`)<br> reference group specification as an `rtables`
`colpath`, see details.</p></dd>


<dt id="arg--spl-context">.spl_context<a class="anchor" aria-label="anchor" href="#arg--spl-context"></a></dt>
<dd><p>see [rtables::spl_context].</p></dd>


<dt id="arg--var">.var<a class="anchor" aria-label="anchor" href="#arg--var"></a></dt>
<dd><p>the variable being analyzed, see [rtables::additional_fun_params].</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list with `ref_group` and `in_ref_col`, which can be used as
  `.ref_group` and `.in_ref_col` as if being directly passed to an analysis
  function by `rtables`, see [rtables::additional_fun_params].</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The reference group is specified in `colpath` hierarchical fashion in `ref_path`:
The first column split variable is the first element, and the level to use is the
second element. It continues until the last column split variable with last
level to use.
Note that depending on `.var`, either a `data.frame` (if `.var` is `NULL`) or
a vector (otherwise) is returned. This allows usage for analysis functions with
`df` and `x` arguments, respectively.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">dm</span> <span class="op">&lt;-</span> <span class="va">DM</span></span></span>
<span class="r-in"><span><span class="va">dm</span><span class="op">$</span><span class="va">colspan_trt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">dm</span><span class="op">$</span><span class="va">ARM</span> <span class="op">==</span> <span class="st">'B: Placebo'</span>, <span class="st">' '</span>, <span class="st">'Active Study Agent'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'Active Study Agent'</span>, <span class="st">' '</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">colspan_trt_map</span> <span class="op">&lt;-</span> <span class="fu"><a href="colspan_map.html">create_colspan_map</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">dm</span>,</span></span>
<span class="r-in"><span>  non_active_grp <span class="op">=</span> <span class="st">'B: Placebo'</span>,</span></span>
<span class="r-in"><span>  non_active_grp_span_lbl <span class="op">=</span> <span class="st">' '</span>,</span></span>
<span class="r-in"><span>  active_grp_span_lbl <span class="op">=</span> <span class="st">'Active Study Agent'</span>,</span></span>
<span class="r-in"><span>  colspan_var <span class="op">=</span> <span class="st">'colspan_trt'</span>,</span></span>
<span class="r-in"><span>  trt_var <span class="op">=</span> <span class="st">'ARM'</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># A standard analysis function which uses a reference group.</span></span></span>
<span class="r-in"><span><span class="va">standard_afun</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">.ref_group</span>, <span class="va">.in_ref_col</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="fu">in_rows</span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="st">'Difference of Averages'</span> <span class="op">=</span> <span class="fu">non_ref_rcell</span><span class="op">(</span></span></span>
<span class="r-in"><span>      <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">.ref_group</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>      is_ref <span class="op">=</span> <span class="va">.in_ref_col</span>,</span></span>
<span class="r-in"><span>      format <span class="op">=</span> <span class="st">'xx.xx'</span></span></span>
<span class="r-in"><span>    <span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># The custom analysis function which can work with a global reference group.</span></span></span>
<span class="r-in"><span><span class="va">result_afun</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">ref_path</span>, <span class="va">.spl_context</span>, <span class="va">.var</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="va">ref</span> <span class="op">&lt;-</span> <span class="fu">get_ref_info</span><span class="op">(</span><span class="va">ref_path</span>, <span class="va">.spl_context</span>, <span class="va">.var</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu">standard_afun</span><span class="op">(</span><span class="va">x</span>, .ref_group <span class="op">=</span> <span class="va">ref</span><span class="op">$</span><span class="va">ref_group</span>, .in_ref_col <span class="op">=</span> <span class="va">ref</span><span class="op">$</span><span class="va">in_ref_col</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Define the global reference group colpath.</span></span></span>
<span class="r-in"><span><span class="va">ref_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'colspan_trt'</span>, <span class="st">' '</span>, <span class="st">'ARM'</span>, <span class="st">'B: Placebo'</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">lyt</span> <span class="op">&lt;-</span> <span class="fu">basic_table</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu">split_cols_by</span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="st">'colspan_trt'</span>,</span></span>
<span class="r-in"><span>    split_fun <span class="op">=</span> <span class="fu">trim_levels_to_map</span><span class="op">(</span>map <span class="op">=</span> <span class="va">colspan_trt_map</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu">split_cols_by</span><span class="op">(</span><span class="st">'ARM'</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu">analyze</span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="st">'AGE'</span>,</span></span>
<span class="r-in"><span>    <span class="co"># Here we pass the global reference group colpath.</span></span></span>
<span class="r-in"><span>    extra_args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>ref_path <span class="op">=</span> <span class="va">ref_path</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    afun <span class="op">=</span> <span class="va">result_afun</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">build_table</span><span class="op">(</span><span class="va">lyt</span>, <span class="va">dm</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                              Active Study Agent                 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                          A: Drug X   C: Combination   B: Placebo</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ————————————————————————————————————————————————————————————————</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Difference of Averages     1.89           1.55                  </span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Gabriel Becker, Ilse Augustyns, Paul Jenkins, Daniel Hofstaedter, Joseph Kovach, David Munoz Tord, Daniel Sabanes Bove, Ezequiel Anokian, Renfei Mao, Mrinal Das, Johnson &amp; Johnson Innovative Medicine.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

