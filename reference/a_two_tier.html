<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Two Tier Analysis Function — a_two_tier • junco</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Two Tier Analysis Function — a_two_tier"><meta name="description" content='The analysis function used as an afun in analyze.
This function simulates a final additional level of nesting with a
traditional analyze call inside it.
This makes it possible to create what appear to be group summary or
content rows and to optionally or conditionally generate one or more
"detail" rows underneath it.
For example, in a disposition table, one might want counts for completed
and ongoing patients with no further detail underneath, but a breakdown of
specific reasons beneath the count of patients who discontinued treatment.'><meta property="og:description" content='The analysis function used as an afun in analyze.
This function simulates a final additional level of nesting with a
traditional analyze call inside it.
This makes it possible to create what appear to be group summary or
content rows and to optionally or conditionally generate one or more
"detail" rows underneath it.
For example, in a disposition table, one might want counts for completed
and ongoing patients with no further detail underneath, but a breakdown of
specific reasons beneath the count of patients who discontinued treatment.'><meta property="og:image" content="https://johnsonandjohnson.github.io/junco/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">junco</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/index.html">Articles</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/johnsonandjohnson/junco/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Two Tier Analysis Function</h1>
      <small class="dont-index">Source: <a href="https://github.com/johnsonandjohnson/junco/blob/main/R/a_two_tier.R" class="external-link"><code>R/a_two_tier.R</code></a></small>
      <div class="d-none name"><code>a_two_tier.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>The analysis function used as an <code>afun</code> in <a href="https://insightsengineering.github.io/rtables/latest-tag/reference/analyze.html" class="external-link">analyze</a>.
This function simulates a final additional level of nesting with a
traditional analyze call inside it.</p>
<p>This makes it possible to create what <em>appear to be</em> group summary or
content rows and to <em>optionally or conditionally</em> generate one or more
"detail" rows underneath it.</p>
<p>For example, in a disposition table, one might want counts for completed
and ongoing patients with no further detail underneath, but a breakdown of
specific reasons beneath the count of patients who discontinued treatment.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">a_two_tier</span><span class="op">(</span></span>
<span>  <span class="va">df</span>,</span>
<span>  labelstr <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">.var</span>,</span>
<span>  <span class="va">.N_col</span>,</span>
<span>  <span class="va">.df_row</span>,</span>
<span>  <span class="va">inner_var</span>,</span>
<span>  <span class="va">drill_down_levs</span>,</span>
<span>  <span class="va">.spl_context</span>,</span>
<span>  use_all_levels <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">grp_fun</span>,</span>
<span>  <span class="va">detail_fun</span>,</span>
<span>  .alt_df_full <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-df">df<a class="anchor" aria-label="anchor" href="#arg-df"></a></dt>
<dd><p>(<code>data.frame</code>)<br> data set containing all analysis variables.</p></dd>


<dt id="arg-labelstr">labelstr<a class="anchor" aria-label="anchor" href="#arg-labelstr"></a></dt>
<dd><p>(<code>character</code>)<br> label of the level of the parent split currently being summarized
(must be present as second argument in Content Row Functions). See <code><a href="https://insightsengineering.github.io/rtables/latest-tag/reference/summarize_row_groups.html" class="external-link">rtables::summarize_row_groups()</a></code>
for more information.</p></dd>


<dt id="arg--var">.var<a class="anchor" aria-label="anchor" href="#arg--var"></a></dt>
<dd><p>(<code>string</code>)<br> single variable name that is passed by <code>rtables</code> when requested
by a statistics function.</p></dd>


<dt id="arg--n-col">.N_col<a class="anchor" aria-label="anchor" href="#arg--n-col"></a></dt>
<dd><p>(<code>integer</code>)<br> column-wise N (column count) for the full column being analyzed that is typically
passed by <code>rtables</code>.</p></dd>


<dt id="arg--df-row">.df_row<a class="anchor" aria-label="anchor" href="#arg--df-row"></a></dt>
<dd><p>(<code>data.frame</code>)<br> data frame across all of the columns for the given row split.</p></dd>


<dt id="arg-inner-var">inner_var<a class="anchor" aria-label="anchor" href="#arg-inner-var"></a></dt>
<dd><p>(<code>string</code>)<br> single variable name to use when generating
the detail rows.</p></dd>


<dt id="arg-drill-down-levs">drill_down_levs<a class="anchor" aria-label="anchor" href="#arg-drill-down-levs"></a></dt>
<dd><p>(<code>character</code>)<br> the level(s) of <code>.var</code> under which
detail rows should be generated.</p></dd>


<dt id="arg--spl-context">.spl_context<a class="anchor" aria-label="anchor" href="#arg--spl-context"></a></dt>
<dd><p>(<code>data.frame</code>)<br> gives information about ancestor split states
that is passed by <code>rtables</code>.</p></dd>


<dt id="arg-use-all-levels">use_all_levels<a class="anchor" aria-label="anchor" href="#arg-use-all-levels"></a></dt>
<dd><p>(<code>flag</code>)<br> controls which factor levels will be
present for <code>inner_var</code> (both in <code>df</code>/<code>x</code> and in <code>.df_row</code>) when calling
<code>detail_fun</code>.
If <code>TRUE</code>, all levels (those present on the factor <code>.df_row[[inner_var]]</code>,
*regardless if the level is observed in the row group or not) will be
present when creating detail rows.
Otherwise (the default), only the levels observed
<em>anywhere in the row group, i.e., within <code>.df_row</code></em> will be present.</p></dd>


<dt id="arg-grp-fun">grp_fun<a class="anchor" aria-label="anchor" href="#arg-grp-fun"></a></dt>
<dd><p>(<code>function</code>)<br> analysis function to be used when generating
the "group summary" outer rows.</p></dd>


<dt id="arg-detail-fun">detail_fun<a class="anchor" aria-label="anchor" href="#arg-detail-fun"></a></dt>
<dd><p>(<code>function</code>)<br> analysis function to be used when generating
"detail" inner rows.</p></dd>


<dt id="arg--alt-df-full">.alt_df_full<a class="anchor" aria-label="anchor" href="#arg--alt-df-full"></a></dt>
<dd><p>(<code>dataframe</code>)<br> denominator dataset for fraction and
relative risk calculations.<br>
this argument gets populated by the rtables split machinery
(see <a href="https://insightsengineering.github.io/rtables/latest-tag/reference/additional_fun_params.html" class="external-link">rtables::additional_fun_params</a>).</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>additional arguments passed directly to <code>grp_fun</code> and <code>detail_fun</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A <code>RowsVerticalSection</code> object including both the group row and all
detail rows, if applicable, for the facet.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Both the analysis variable and <code>inner_var</code> must be factors.
Detail rows are differentiated by having an indent mod of one, causing them
to hang indented under their corresponding group row.</p>
    </div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>In its current form, this function may not retain any formatting or
labeling instructions added by <code>grp_fun</code> or <code>detail_fun</code>, and it will
override any <code>.indent_mods</code> values specified by them. This behavior may
change in future versions.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>GB, WW.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Example 1</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">lyt_obs_levels</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://insightsengineering.github.io/rtables/latest-tag/reference/basic_table.html" class="external-link">basic_table</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://insightsengineering.github.io/rtables/latest-tag/reference/split_cols_by.html" class="external-link">split_cols_by</a></span><span class="op">(</span><span class="st">"ARM"</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://insightsengineering.github.io/rtables/latest-tag/reference/split_rows_by.html" class="external-link">split_rows_by</a></span><span class="op">(</span><span class="st">"EOSSTT"</span>, child_labels <span class="op">=</span> <span class="st">"hidden"</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://insightsengineering.github.io/rtables/latest-tag/reference/analyze.html" class="external-link">analyze</a></span><span class="op">(</span><span class="st">"EOSSTT"</span>,</span></span>
<span class="r-in"><span>    afun <span class="op">=</span> <span class="va">a_two_tier</span>,</span></span>
<span class="r-in"><span>    extra_args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>      grp_fun <span class="op">=</span> <span class="va">simple_analysis</span>,</span></span>
<span class="r-in"><span>      detail_fun <span class="op">=</span> <span class="va">simple_analysis</span>,</span></span>
<span class="r-in"><span>      inner_var <span class="op">=</span> <span class="st">"DCSREAS"</span>,</span></span>
<span class="r-in"><span>      drill_down_levs <span class="op">=</span> <span class="st">"DISCONTINUED"</span></span></span>
<span class="r-in"><span>    <span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">tbl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://insightsengineering.github.io/rtables/latest-tag/reference/build_table.html" class="external-link">build_table</a></span><span class="op">(</span><span class="va">lyt_obs_levels</span>, <span class="va">ex_adsl</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">tbl</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                   A: Drug X   B: Placebo   C: Combination</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> —————————————————————————————————————————————————————————————————————————</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> COMPLETED                            69           69             72      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DISCONTINUED                         38           43             39      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ADVERSE EVENT                       6           6              7       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   LACK OF EFFICACY                   11           10             6       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   PHYSICIAN DECISION                  3           8              6       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   PROTOCOL VIOLATION                  6           9              6       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   WITHDRAWAL BY PARENT/GUARDIAN       8           2              4       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   WITHDRAWAL BY SUBJECT               4           8              10      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ONGOING                              27           22             21      </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">lyt_all_levels</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://insightsengineering.github.io/rtables/latest-tag/reference/basic_table.html" class="external-link">basic_table</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://insightsengineering.github.io/rtables/latest-tag/reference/split_cols_by.html" class="external-link">split_cols_by</a></span><span class="op">(</span><span class="st">"ARM"</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://insightsengineering.github.io/rtables/latest-tag/reference/split_rows_by.html" class="external-link">split_rows_by</a></span><span class="op">(</span><span class="st">"EOSSTT"</span>, child_labels <span class="op">=</span> <span class="st">"hidden"</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://insightsengineering.github.io/rtables/latest-tag/reference/analyze.html" class="external-link">analyze</a></span><span class="op">(</span><span class="st">"EOSSTT"</span>,</span></span>
<span class="r-in"><span>    afun <span class="op">=</span> <span class="va">a_two_tier</span>,</span></span>
<span class="r-in"><span>    extra_args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>      grp_fun <span class="op">=</span> <span class="va">simple_analysis</span>,</span></span>
<span class="r-in"><span>      detail_fun <span class="op">=</span> <span class="va">simple_analysis</span>,</span></span>
<span class="r-in"><span>      inner_var <span class="op">=</span> <span class="st">"DCSREAS"</span>,</span></span>
<span class="r-in"><span>      drill_down_levs <span class="op">=</span> <span class="st">"DISCONTINUED"</span>,</span></span>
<span class="r-in"><span>      use_all_levels <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span>    <span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">adsl_subset</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">ex_adsl</span>, <span class="va">DCSREAS</span> <span class="op">!=</span> <span class="st">"ADVERSE EVENT"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="va">adsl_subset</span><span class="op">$</span><span class="va">DCSREAS</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "ADVERSE EVENT"                 "LACK OF EFFICACY"             </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3] "PHYSICIAN DECISION"            "PROTOCOL VIOLATION"           </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [5] "WITHDRAWAL BY PARENT/GUARDIAN" "WITHDRAWAL BY SUBJECT"        </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">tbl_all_levels</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://insightsengineering.github.io/rtables/latest-tag/reference/build_table.html" class="external-link">build_table</a></span><span class="op">(</span><span class="va">lyt_all_levels</span>, <span class="va">adsl_subset</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">tbl_all_levels</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                   A: Drug X   B: Placebo   C: Combination</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> —————————————————————————————————————————————————————————————————————————</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> COMPLETED                             0           0              0       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DISCONTINUED                         32           37             32      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ADVERSE EVENT                       0           0              0       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   LACK OF EFFICACY                   11           10             6       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   PHYSICIAN DECISION                  3           8              6       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   PROTOCOL VIOLATION                  6           9              6       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   WITHDRAWAL BY PARENT/GUARDIAN       8           2              4       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   WITHDRAWAL BY SUBJECT               4           8              10      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ONGOING                               0           0              0       </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">tbl_obs_levels</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://insightsengineering.github.io/rtables/latest-tag/reference/build_table.html" class="external-link">build_table</a></span><span class="op">(</span><span class="va">lyt_obs_levels</span>, <span class="va">adsl_subset</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">tbl_obs_levels</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                   A: Drug X   B: Placebo   C: Combination</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> —————————————————————————————————————————————————————————————————————————</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> COMPLETED                             0           0              0       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DISCONTINUED                         32           37             32      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   LACK OF EFFICACY                   11           10             6       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   PHYSICIAN DECISION                  3           8              6       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   PROTOCOL VIOLATION                  6           9              6       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   WITHDRAWAL BY PARENT/GUARDIAN       8           2              4       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   WITHDRAWAL BY SUBJECT               4           8              10      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ONGOING                               0           0              0       </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Example 2</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">trtvar</span> <span class="op">&lt;-</span> <span class="st">"ARM"</span></span></span>
<span class="r-in"><span><span class="va">ctrl_grp</span> <span class="op">&lt;-</span> <span class="st">"B: Placebo"</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">adsl</span> <span class="op">&lt;-</span> <span class="va">ex_adsl</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"USUBJID"</span>, <span class="st">"STRATA1"</span>, <span class="st">"EOSSTT"</span>, <span class="st">"DCSREAS"</span>, <span class="fu"><a href="https://tidyselect.r-lib.org/reference/all_of.html" class="external-link">all_of</a></span><span class="op">(</span><span class="va">trtvar</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">adsl</span><span class="op">$</span><span class="va">colspan_trt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">adsl</span><span class="op">[[</span><span class="va">trtvar</span><span class="op">]</span><span class="op">]</span> <span class="op">==</span> <span class="va">ctrl_grp</span>, <span class="st">" "</span>, <span class="st">"Active Study Agent"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Active Study Agent"</span>, <span class="st">" "</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">adsl</span><span class="op">$</span><span class="va">rrisk_header</span> <span class="op">&lt;-</span> <span class="st">"Risk Difference (%) (95% CI)"</span></span></span>
<span class="r-in"><span><span class="va">adsl</span><span class="op">$</span><span class="va">rrisk_label</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">adsl</span><span class="op">[[</span><span class="va">trtvar</span><span class="op">]</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"vs"</span>, <span class="va">ctrl_grp</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">colspan_trt_map</span> <span class="op">&lt;-</span> <span class="fu"><a href="colspan_map.html">create_colspan_map</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  df <span class="op">=</span> <span class="va">adsl</span>,</span></span>
<span class="r-in"><span>  non_active_grp <span class="op">=</span> <span class="va">ctrl_grp</span>,</span></span>
<span class="r-in"><span>  non_active_grp_span_lbl <span class="op">=</span> <span class="st">" "</span>,</span></span>
<span class="r-in"><span>  active_grp_span_lbl <span class="op">=</span> <span class="st">"Active Study Agent"</span>,</span></span>
<span class="r-in"><span>  colspan_var <span class="op">=</span> <span class="st">"colspan_trt"</span>,</span></span>
<span class="r-in"><span>  trt_var <span class="op">=</span> <span class="va">trtvar</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">a_freq_j_args</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  .stats <span class="op">=</span> <span class="st">"count_unique_fraction"</span>,</span></span>
<span class="r-in"><span>  denom <span class="op">=</span> <span class="st">"n_altdf"</span>,</span></span>
<span class="r-in"><span>  ref_path <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"colspan_trt"</span>, <span class="st">" "</span>, <span class="va">trtvar</span>, <span class="va">ctrl_grp</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">two_tier_args</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  grp_fun <span class="op">=</span> <span class="va">a_freq_j</span>,</span></span>
<span class="r-in"><span>  detail_fun <span class="op">=</span> <span class="va">a_freq_j</span>,</span></span>
<span class="r-in"><span>  inner_var <span class="op">=</span> <span class="st">"DCSREAS"</span>,</span></span>
<span class="r-in"><span>  drill_down_levs <span class="op">=</span> <span class="st">"DISCONTINUED"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">lyt_rrisk</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://insightsengineering.github.io/rtables/latest-tag/reference/basic_table.html" class="external-link">basic_table</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://insightsengineering.github.io/rtables/latest-tag/reference/split_cols_by.html" class="external-link">split_cols_by</a></span><span class="op">(</span><span class="st">"colspan_trt"</span>, split_fun <span class="op">=</span> <span class="fu"><a href="https://insightsengineering.github.io/rtables/latest-tag/reference/trim_levels_to_map.html" class="external-link">trim_levels_to_map</a></span><span class="op">(</span>map <span class="op">=</span> <span class="va">colspan_trt_map</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://insightsengineering.github.io/rtables/latest-tag/reference/split_cols_by.html" class="external-link">split_cols_by</a></span><span class="op">(</span><span class="va">trtvar</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://insightsengineering.github.io/rtables/latest-tag/reference/split_cols_by.html" class="external-link">split_cols_by</a></span><span class="op">(</span><span class="st">"rrisk_header"</span>, nested <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://insightsengineering.github.io/rtables/latest-tag/reference/split_cols_by.html" class="external-link">split_cols_by</a></span><span class="op">(</span><span class="va">trtvar</span>, labels_var <span class="op">=</span> <span class="st">"rrisk_label"</span>, split_fun <span class="op">=</span> <span class="fu"><a href="https://insightsengineering.github.io/rtables/latest-tag/reference/split_funcs.html" class="external-link">remove_split_levels</a></span><span class="op">(</span><span class="va">ctrl_grp</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://insightsengineering.github.io/rtables/latest-tag/reference/split_rows_by.html" class="external-link">split_rows_by</a></span><span class="op">(</span><span class="st">"STRATA1"</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://insightsengineering.github.io/rtables/latest-tag/reference/split_rows_by.html" class="external-link">split_rows_by</a></span><span class="op">(</span><span class="st">"EOSSTT"</span>, child_labels <span class="op">=</span> <span class="st">"hidden"</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://insightsengineering.github.io/rtables/latest-tag/reference/analyze.html" class="external-link">analyze</a></span><span class="op">(</span><span class="st">"EOSSTT"</span>, afun <span class="op">=</span> <span class="va">a_two_tier</span>, extra_args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">two_tier_args</span>, <span class="va">a_freq_j_args</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">adsl_subset</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">adsl</span>,</span></span>
<span class="r-in"><span>  <span class="va">EOSSTT</span> <span class="op">!=</span> <span class="st">"COMPLETED"</span> <span class="op">&amp;</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">DCSREAS</span><span class="op">)</span> <span class="op">|</span> <span class="va">DCSREAS</span> <span class="op">!=</span> <span class="st">"PROTOCOL VIOLATION"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">tbl_rrisk</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://insightsengineering.github.io/rtables/latest-tag/reference/build_table.html" class="external-link">build_table</a></span><span class="op">(</span><span class="va">lyt_rrisk</span>, <span class="va">adsl_subset</span>, alt_counts_df <span class="op">=</span> <span class="va">adsl_subset</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">tbl_rrisk</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                         Active Study Agent                                  Risk Difference (%) (95% CI)             </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                     A: Drug X    C: Combination   B: Placebo   A: Drug X vs B: Placebo   C: Combination vs B: Placebo</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> —————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> A                                                                                                                                    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   COMPLETED                             0              0              0            0.0 (0.0, 0.0)               0.0 (0.0, 0.0)       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   DISCONTINUED                      9 (15.3%)      12 (22.2%)     10 (17.9%)     -2.6 (-16.2, 11.0)           4.4 (-10.6, 19.3)      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     ADVERSE EVENT                    3 (5.1%)       1 (1.9%)       3 (5.4%)       -0.3 (-8.4, 7.9)            -3.5 (-10.4, 3.4)      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     LACK OF EFFICACY                 4 (6.8%)       3 (5.6%)       1 (1.8%)       5.0 (-2.3, 12.3)             3.8 (-3.3, 10.8)      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     PHYSICIAN DECISION               1 (1.7%)       1 (1.9%)       3 (5.4%)       -3.7 (-10.4, 3.1)           -3.5 (-10.4, 3.4)      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     WITHDRAWAL BY PARENT/GUARDIAN    1 (1.7%)       2 (3.7%)       1 (1.8%)       -0.1 (-4.9, 4.7)             1.9 (-4.2, 8.0)       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     WITHDRAWAL BY SUBJECT               0           5 (9.3%)       2 (3.6%)       -3.6 (-8.4, 1.3)             5.7 (-3.4, 14.8)      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ONGOING                            5 (8.5%)       5 (9.3%)      8 (14.3%)       -5.8 (-17.4, 5.8)           -5.0 (-17.0, 7.0)      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> B                                                                                                                                    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   COMPLETED                             0              0              0            0.0 (0.0, 0.0)               0.0 (0.0, 0.0)       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   DISCONTINUED                      10 (16.9%)     10 (18.5%)     14 (25.0%)      -8.1 (-22.9, 6.8)           -6.5 (-21.8, 8.9)      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     ADVERSE EVENT                       0           4 (7.4%)       1 (1.8%)       -1.8 (-5.3, 1.7)             5.6 (-2.2, 13.4)      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     LACK OF EFFICACY                 5 (8.5%)       2 (3.7%)      7 (12.5%)       -4.0 (-15.2, 7.2)           -8.8 (-18.8, 1.2)      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     PHYSICIAN DECISION               1 (1.7%)       3 (5.6%)       2 (3.6%)       -1.9 (-7.7, 4.0)             2.0 (-5.8, 9.8)       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     WITHDRAWAL BY PARENT/GUARDIAN    4 (6.8%)          0           1 (1.8%)       5.0 (-2.3, 12.3)             -1.8 (-5.3, 1.7)      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     WITHDRAWAL BY SUBJECT               0           1 (1.9%)       3 (5.4%)       -5.4 (-11.3, 0.5)           -3.5 (-10.4, 3.4)      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ONGOING                           12 (20.3%)     6 (11.1%)      8 (14.3%)       6.1 (-7.7, 19.8)            -3.2 (-15.6, 9.2)      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> C                                                                                                                                    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   COMPLETED                             0              0              0            0.0 (0.0, 0.0)               0.0 (0.0, 0.0)       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   DISCONTINUED                      13 (22.0%)     11 (20.4%)     10 (17.9%)      4.2 (-10.4, 18.8)           2.5 (-12.2, 17.2)      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     ADVERSE EVENT                    3 (5.1%)       2 (3.7%)       2 (3.6%)        1.5 (-5.9, 8.9)             0.1 (-6.9, 7.1)       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     LACK OF EFFICACY                 2 (3.4%)       1 (1.9%)       2 (3.6%)       -0.2 (-6.9, 6.5)             -1.7 (-7.8, 4.3)      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     PHYSICIAN DECISION               1 (1.7%)       2 (3.7%)       3 (5.4%)       -3.7 (-10.4, 3.1)            -1.7 (-9.4, 6.1)      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     WITHDRAWAL BY PARENT/GUARDIAN    3 (5.1%)       2 (3.7%)          0           5.1 (-0.5, 10.7)             3.7 (-1.3, 8.7)       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     WITHDRAWAL BY SUBJECT            4 (6.8%)       4 (7.4%)       3 (5.4%)       1.4 (-7.3, 10.1)             2.1 (-7.1, 11.2)      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ONGOING                           10 (16.9%)     10 (18.5%)     6 (10.7%)       6.2 (-6.3, 18.8)             7.8 (-5.3, 21.0)      </span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Gabriel Becker, Ilse Augustyns, Paul Jenkins, Daniel Hofstaedter, Joseph Kovach, David Munoz Tord, Daniel Sabanes Bove, Ezequiel Anokian, Renfei Mao, Mrinal Das, Wojciech Wojciak, Johnson &amp; Johnson Innovative Medicine.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

